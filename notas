function verHistorial(idPaciente) {
  console.log("Ver historial del paciente con ID:", idPaciente);

  fetch(`./Conexion/obtener_paciente.php?id=${idPaciente}`)
    .then((response) => {
      if (!response.ok) {
        throw new Error(`Error al obtener datos: ${response.statusText}`);
      }
      return response.json();
    })
    .then((data) => {
      if (data.error) {
        alert(`Error: ${data.error}`);
        return;
      }

      const paciente = data.paciente;

      // Llenar los campos del formulario con los datos obtenidos
      document.getElementById("historial_nombre").value = paciente.nombre || "";
      document.getElementById("historial_ap").value = paciente.ap || "";
      document.getElementById("historial_am").value = paciente.am || "";
      document.getElementById("historial_fn").value = paciente.fechaN || "";
      document.getElementById("historial_telefono").value =
        paciente.telefono || "";
      document.getElementById("historial_mail").value = paciente.correo || "";
      document.getElementById("historial_calle").value = paciente.calle || "";
      document.getElementById("historial_col").value = paciente.colonia || "";
      document.getElementById("historial_municipio").value =
        paciente.municipio || "";
      document.getElementById("historial_estado").value = paciente.estado || "";

      // Llenar antecedentes patológicos
      data.patologicos.forEach((patologico) => {
        const check = document.getElementById(
          `historial_check-${patologico.nombre
            .toLowerCase()
            .replace(/ /g, "-")}`
        );
        const text = document.getElementById(
          `historial_text-${patologico.nombre.toLowerCase().replace(/ /g, "-")}`
        );
        if (check) {
          check.checked = patologico.estado === "1";
        }
        if (text) {
          text.value = patologico.descripcion || "";
        }
      });

      // Llenar antecedentes no patológicos
      data.noPatologicos.forEach((noPatologico) => {
        const check = document.getElementById(
          `historial_check-${noPatologico.nombre
            .toLowerCase()
            .replace(/ /g, "-")}`
        );
        const text = document.getElementById(
          `historial_text-${noPatologico.nombre
            .toLowerCase()
            .replace(/ /g, "-")}`
        );
        if (check) {
          check.checked = noPatologico.estado === "1";
        }
        if (text) {
          text.value = noPatologico.descripcion || "";
        }
      });

      // Asociar el ID del paciente al botón de actualizar
      document.getElementById("botonActualizar").dataset.id = idPaciente;
    })
    .catch((error) => console.error("Error:", error));
}
